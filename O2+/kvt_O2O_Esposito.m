function out=kvt_O2O_Esposito(ii, idi, T, O2)
% k i->i-di by Esposito 2008
% 23.02.2021
cijk(1, :, :)=[
1.1 -26.18993227    -19.45675583    -3.993663 2.821759
1.2 0               -3.38007590     2.684515 4.083138
1.3 0               89.85158436     -1.009927e5 -8.809991e1
1.4 0               5.853646e-2     -0.283676 2.369644e-2
2.1 -1.69828917     -1.48712025     -3.030965 3.841080
2.2 0               -0.54018334     -4.594443 -0.998637
2.3 0               -53.33457116    3.590903e4 -3.438479e1
2.4 0               -9.543789e-2    7.104764e-2 1.222381e-2
3.1 3.349076e19     1.505136e21     5.492061e21 4.330479e21
3.2 0               1.621622e21     1.212196e21 -1.677646e22
3.3 0               -1.066183e21    9.092488e21 -5.573334e21
3.4 0               2.169160e20     1.540038e20 -3.089812e19
4.1 -3.946126e20    -1.532916e20    1.308503e20 -1.194045e20
4.2 0               -4.105380e19    1.831856e20 -5.121704e19
4.3 0               1.185042e21     1.079540e22 4.013656e21
4.4 0               -1.748646e18 -5.608629e18 -1.052730e18
5.1 1.391056e19     -4.838473e18 2.160753e19 -9.939380e18
5.2 0               9.529399e18  -1.465914e19 4.180038e18
5.3 0               5.290114e19  5.483520e21 -2.265448e18
5.4 0               6.021495e16  1.142128e17 1.050411e16];
cijk(2,:,:)=[
1.1 7.83331061  14.47821980   -7.575157e1 -1.066105e2
1.2 0           -43.32225364  -9.234026 6.618737e1
1.3 0           -348.16803354 2.807916e5 2.630406e2
1.4 0           -0.16418596   0.333397 2.791153e-2
2.1 3.71221451  32.66821082   -7.713850 -2.658559e1
2.2 0           -0.18462189   2.545634e1 -9.167211
2.3 0           119.03129957  -9.592245e4 1.678357e2
2.4 0           0.22258852    -0.179262 -0.106474
3.1 3.573261e20 1.522507e21   4.002520e21 1.312884e22
3.2 0           2.654567e21   -8.192010e21 -5.437653e21
3.3 0           -3.528669e21  1.462011e23 5.735816e21
3.4 0           -2.861293e20  -1.821224e20 1.568233e20
4.1 6.433503e20 -1.533872e21  -2.912948e21 4.530951e21
4.2 0           -1.522587e20  6.399791e19 2.662341e20
4.3 0           -3.124046e21  -3.531505e22 -2.932068e22
4.4 0           2.322209e19 1.964744e19 6.788371e18
5.1 -2.901352e19 -3.762650e19 -7.070723e19 -3.473472e19
5.2 0            1.955942e19  4.805948e19 -5.623449e18
5.3 0            8.847719e18  5.201014e21 2.765213e20
5.4 0            -8.252347e17 -4.170396e17 -6.030509e16];
cijk(3,:,:)=[
1.1 0.37163948      0.88657647      -1.271181       -3.476825
1.2 0               -1.14258799     0.317834        -0.415675
1.3 0               -4.53080420     5.830886e3      2.341590e1
1.4 0               4.732032e-3     7.186328e-3     -1.760866e-3
2.1 0.10587091      -0.18566919     -0.709028       -0.562411
2.2 0               -0.19256423     4.753706e-2     0.166319
2.3 0               3.95819117      -1.757570e3     2.356659
2.4 0               1.353007e-2     1.465161e-3     -7.409818e-4
3.1 -5.312491e19    -2.027215e21    -8.686388e20    1.908092e21
3.2 0               2.381051e21     9.428176e20     1.107010e21
3.3 0               -1.248596e20    1.738719e22     -1.769244e22
3.4 0               -4.014395e19    -1.251868e19    1.272578e18
4.1 3.754092e19     1.819921e19     1.877581e19     -2.139241e19
4.2 0               3.708631e19     1.097908e19     2.171483e19
4.3 0               2.031805e19     -1.006633e22    -2.478535e19
4.4 0               -6.021031e17    2.734279e16     7.612186e16
5.1 -1.189832e18    1.530423e18     2.238756e18     1.542813e18
5.2 0               -1.859900e18    -7.688157e17    -7.531694e17
5.3 0               -8.207403e18    -2.061752e21    -4.924709e18
5.4 0               9.708459e15     -3.427940e15    -5.546602e14];

% K=DegF*exp(a1+a2/log(T)+a3*log(T));
DegF=1/27;
di_arr=zeros(1,30)+2;
di_arr(2:10)=3;
di_arr(11:20)=4;
di_arr(21:30)=5;
b=zeros(3,5,30);
for ia=1:3
 for ib=1:5
  for di=1:30
   b(ia,ib,di)=  cijk(ia,(ib-1)*4+ 1 ,di_arr(di))...
                +cijk(ia,(ib-1)*4+ 2 ,di_arr(di))*log(di)...
                +cijk(ia,(ib-1)*4+ 3 ,di_arr(di))*di*exp(-di)...
                +cijk(ia,(ib-1)*4+ 4 ,di_arr(di))*di*di;
  end
 end
end
en=[
  -5.117075800651167    0
  -4.921075800651168    1
  -4.729075800651168    2
  -4.544075800651168    3
  -4.361075800651167    4
  -4.180075800651167    5
  -4.000075800651167    6
  -3.826075800651167    7
  -3.656075800651167    8
  -3.488075800651167    9
  -3.321075800651167    10
  -3.157075800651167    11
  -2.995075800651168    12
  -2.836075800651167    13
  -2.682075800651167    14
  -2.530075800651167    15
  -2.382075800651168    16
  -2.236075800651168    17
  -2.093075800651168    18
  -1.953075800651167    19
  -1.816075800651167    20
  -1.681075800651167    21
  -1.549075800651167    22
  -1.421075800651167    23
  -1.296075800651167    24
  -1.175075800651167    25
  -1.058075800651167    26
  -0.945075800651168    27
  -0.837075800651167    28
  -0.735075800651168    30
  -0.641075800651167    31
  -0.552075800651167    32
  -0.466075800651168    33
  -0.387075800651167    34
  -0.323075800651168    35
  -0.270075800651167    36
  -0.219075800651168    37
  -0.179075800651168    38
  -0.157075800651167    38
  -0.141075800651167    38
  -0.130075800651167    39
  -0.123075800651168    39];
% out=zeros(length(n),1);
% for di=1:30
% for i=1:41
%     v=en(ii+1,2);
    v=ii;
    if ii-idi>=0
%      if v-en(i-di+1,2)<31
%         dv=v-en(ii-idi+1,2);
        dv=idi;
        if dv==0
            dv=1;
        end
        a=b(:,1,dv)+b(:,2,dv)*log(v)...
                    +(b(:,3,dv)+b(:,4,dv)*v+b(:,5,dv)*v.^2)/(1e21+exp(v));
        krate=DegF*exp(a(1)+a(2)./log(T)+a(3)*log(T))/1e6;
        k = 1.3807e-23;
        kbf=krate*exp(-(O2.e_i(1,ii+1)-O2.e_i(1,ii-idi+1))/k/T);
        out=krate;
%         disp([num2str(v) ' ' num2str(dv) ' ' num2str(T)])
%         disp(num2str(b(2,1,dv),'%.15f'))
%      end
    end
%  end
% end
end